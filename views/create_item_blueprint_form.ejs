<!-- create_item_blueprint_form -->
<form
  id="createItemBlueprintForm"
  class="sideForm"
  style="display: none"
  autocomplete="off"
>
  <section>
    <label for="newItemName">Name:</label>
    <input
      id="newItemName"
      name="newItemName"
      type="text"
      maxlength="36"
      required
    />
  </section>
  <section>
    <label for="newItemType">Type:</label>
    <select id="newItemType" name="newItemType" required>
      <option value="armor">armor</option>
      <option value="fishing_rod">fishing rod</option>
      <option value="gold">gold</option>
      <option value="key">key</option>
      <option value="none" selected>none</option>
      <option value="potion">potion</option>
      <option value="scroll">scroll</option>
      <option value="token">token</option>
      <option value="treasure">treasure</option>
      <option value="wand">wand</option>
      <option value="weapon">weapon</option>
    </select>
  </section>
  <section>
    <label for="newItemKeywords">Keywords:</label>
    <input
      id="newItemKeywords"
      name="newItemKeywords"
      type="text"
      maxlength="80"
      required
    />
  </section>
  <section>
    <label for="newLookItem">Look:</label>
    <input id="newLookItem" name="newLookItem" type="text" maxlength="80" />
  </section>
  <section>
    <label for="newExamineItem">Examine:</label>
    <textarea
      id="newExamineItem"
      name="newExamineItem"
      type="text"
      maxlength="240"
    ></textarea>
  </section>
  <section>
    <label for="newStudyItem">Study:</label>
    <textarea
      id="newStudyItem"
      name="newStudyItem"
      type="text"
      maxlength="640"
    ></textarea>
  </section>
  <section>
    <label for="newResearchItem">Research:</label>
    <textarea
      id="newResearchItem"
      name="newResearchItem"
      type="text"
      maxlength="1600"
    ></textarea>
  </section>

  <section>
    <label for="newItemPrice">Price:</label>
    <input
      type="number"
      id="newItemPrice"
      name="newItemPrice"
      min="0"
      max="100000"
      value="0"
      required
    />
    <label for="newItemMinimumLevel">MinLvl:</label>
    <select id="newItemMinimumLevel" name="newItemMinimumLevel" required>
      <!-- populated by script -->
    </select>
    <label for="newItemIsContainer">Container: </label>
    <input type="checkbox" id="newItemIsContainer" name="newItemIsContainer" />
  </section>

  <button type="submit">Create Item</button>
  <button type="button" id="cancelcreateItemBlueprintForm">Cancel</button>
</form>

<script>
  const createItemBlueprintForm = document.getElementById(
    "createItemBlueprintForm"
  );

  document.addEventListener("DOMContentLoaded", () => {
    generateNumberSelectOptions(
      1,
      31,
      document.getElementById("newItemMinimumLevel")
    );
  });

  createItemBlueprintForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const createItemBlueprintFormData = {
      name: document.getElementById("newItemName").value,
      itemType: document.getElementById("newItemType").value,
      keywords: document.getElementById("newItemKeywords").value.split(/[ ,]+/),
      description: {
        look: document.getElementById("newLookItem").value,
        examine: document.getElementById("newExamineItem").value,
        study: document.getElementById("newStudyItem").value,
        research: document.getElementById("newResearchItem").value,
      },
      price: document.getElementById("newItemPrice").value,
      minimumLevel: document.getElementById("newItemMinimumLevel").value,
      isContainer: document.getElementById("newItemIsContainer").checked,
    };
    socket.emit("userSubmittedNewItemBlueprint", createItemBlueprintFormData);
    createItemBlueprintForm.reset();
    createItemBlueprintForm.style.display = "none"; // Hide the form after submission
  });

  document
    .getElementById("cancelcreateItemBlueprintForm")
    .addEventListener("click", function () {
      createItemBlueprintForm.style.display = "none";
    });

  socket.on("openCreateItemBlueprintForm", (formData) => {
    console.log(
      `openCreateItemBlueprintForm received formData: ${JSON.stringify(
        formData
      )}`
    );
    activeForm.reset();
    activeForm.style.display = "none";
    activeForm = createItemBlueprintForm;
    activeForm.style.display = "block";
    input.value = "";
  });
</script>
